\section{Сравнение с аналогами}
\label{sec:analogs-comparison}

Единственным непосредственным аналогом разработанной платформы является VSTA. (речь идет о ПО для платформы .NET)  Сравнение будет происходить исходя из опыта применения технологии VSTA в реальном проекте (см раздел \ref{sec:use_exis_techn}). Кроме того, в рамках данной работы необходимо оценить успешнось разработанной платформы как замены устаревшего инструментария VBA, так как один из сценариев применения платформы --- замена VBA при портировании COM/ActveX-приложений, использующих VBA, на платформу .NET.

\subsubsection{Методика сравнительного анализа}

Рассматриваемые плаформы поддержки расширений можно представить как совокупность следующих компонент:

\begin{itemize}
   \item среда разработки расширений;
   \item пользовательский интерфайс (инструментарий для работы с расширениями);
   \item ядро, обеспечивающее взаимодействие приложения с расширениями.
\end{itemize}

Для получения адекватных результатов сравнительный анализ необходимо проводить по каждой из этих компонент. Так как сформулировать критерии для получения точных количественных оценок при сравнении, к примеру, удобства пользовательского интерфейса не представляется возможным, все выводы будут следовать по большей части из личного опыта использования тех или иных продуктов и инструментов, а также из отзывов других разработчиков или пользователей этих продуктов.

Кроме перечисленных компонент системы немаловажным фактором в выборе того или иного продукта будет являться простота его использования. В конце раздела будет проведено сравнение сложности интеграции продуктов в приложение.

\subsubsection{Среда разработки}

VSTA Studio является логичным развитием VB6 Studio, используемой как редактор VBA-кода. Большинство основных элементов управления сргуппированы аналогично и выполняют аналогичные операции в этих IDE. Однако VSTA имеет усовершенствованный визуальный редактор форм, а также новые инструменты IntelliSense, увеличивающие эффективность разработки. Используемая в разработанной платформе IDE SharpDevelop имеет похожий функционал, однако набор возможностей редактора кода не столь широк, как в VSTA Studio. В этом мы убедились ранее, выявив необходимость реализовывать генератор сигнатур обработчиков событий, отсутствующий в SharpDevelop по умолчанию (см. раздел \ref{sec:ehsg}). Помимо этого, из-за того, что эта IDE не подразумевает использования в качестве интегрированой среды разработки расширений, проявилось множество проблем, требующих разрешения (поднобнее про эти проблемы и методы их решения см. раздел \ref{sec:dev-details}). Несмотря на отсутствие некоторых функций в базовом установочном пакете SharpDevelop, его функционал может быть расширен за счёт механизма плагинов, либо за счёт интегрированной технологии SDA.

Средства разработки компании Microsoft предоставляют более шировий набор возможностей <<из коробки>>, однако используемая в разработанной платформе IDE является более гибким и масштабируемым решением. Кроме того, SharpDevelop является полноценной IDE для разработки программ на большом числе .NET-совместимых языков программирования (C\#, VisualBasic.NET, F\#, Boo, IronPython, IronRuby и другие, для которых существуют соответствующие плагины SharpDevelop), в то время как продукты Microsoft поддерживают только Visual Basic и имеют менее богатый встроенный инструментарий для разработчика.

\subsubsection{Пользовательский интерфейс}

Продукты Microsoft не предоставляют графические средства для проведения операций с расширенями. То есть разработчику программного обеспечения необходимо реализовать свой собственный инструментарий в соответствии с поставлеными целями. В разработанную платформу интегрирован пользовательский интерфейс, реализованный на {\it Windows Forms}, предоставляющий основные инструменты для управления расширениями (см. раздел \ref{sec:macro-gui}).

Преимущества такого решения очевидны: разработчику программного обеспечения достаточно встроить готовые компоненты в своё приложение, чтобы получить полнофункциональную систему поддержки расширений. Из недостатков стоит отметить непреемлемость такого решения в случае, если втроенные в платформу элементы нарушают целостность визуального оформления приложения. В этом случае имеет смысл использовать один из паттернов проектирования для предоставления разработчику возможность самому реализовать представления компонент графического интерфейса в соответствии со стилем разрабатываемого приложения~\cite{band-four}.

\subsubsection{Взаимодействие расширения и приложения}

В этом аспекте не имеет смысла сравнивать разработанную платформу с {\it VBA} из-за принципиального отличия модели взаимодействия {\it COM}-компонент и {\it .NET}-библиотек между собой. В свою очередь, используя {\it VSTA}, можно выбрать различные варианты работы с ним. В одном из случаев взаимодействие расширения и приложения будет происходить через {\it System.Addin}, особенности этого подхода были подробно описаны в разделе \ref{sec:system_addin}. В разрабатываемой платформе был выбран {\it .NET Reflection} в качестве основы для организации взаимодействия. По большому счету это и является основным отличием разработанной платформы от {\it VSTA}.

Эта часть платформы хоть и играет, пожалуй, самую важную роль, но скрыта от пользовательских глаз. Поэтому, если все пользовательские сценарии реализованы верно и не возникает проблем со стабильностью и производительностью, по большому счёту не имеет смысла утверждать, что тот или иной подход оказывается лучше или хуже. Минусом исполизуемого подхода (см. раздел \ref{sec:extention_interaction}) является тот факт, что сборки расширения остаются в домене приложения, то есть в памяти, до завершения работы с ним. Это сложно назвать серьёзным недостатком, так как эти <<паразитные>> сборки полностью изолируются и не могут повлиять на работу приложения. Более того, их размер ничтожно мал по сравнению с доступными объёмами памяти, и варьируется от десятков до сотен килобайт, в зависимости от объема кода расширения. В исключительных случаях, если расширение перегружено разнообразными ресурсами, размер может доходить до нескольких мегабайт. Так или иначе, раз проблема <<паразитных>> сборок имеет место только в случае активного использования отладчика расширения и редактирования его кода, она не будет мешать работе с уже готовыми расширениями.

\subsubsection{Интеграция}

Основным преимуществом разработаного решения является относительная простота его интеграции как в существующее приложение, так и на этапе разработки нового приложения. Простота достигается благодаря использованию разработанного механизма взаимодействия расширения и приложения, в основе которого лежит {\it .NET Reflection}. Подробнее особенности реализованного механизма описаны в разделе \ref{sec:extention_interaction}. Для предоставления доступа к объектам программисту требуется всего лишь реализовать этими объектами интерфейс, используемый модулем интеграции расширений разработанной платформы. В то же время, интеграция рассмотренных в обзоре (см. раздел \ref{sec:extention_interaction}) продуктов требует реализации сложных и громоздких протоколов взаимодействия на основе контрактов, а также накладывает некоторые условия на архитектуру разрабатываемого приложения. Конечно, в этом случае достигается изоляция расширения от приложения, но при этом интеграция сильно усложнена.

Так же стоит отметить наличие в разработанной платформе средств для управления расширениями, которые могут быть легко добавлены полностью или частично в целевое приложение на этапе интеграции. Если же такой вариант разработчика не устроит, он может реализовать собственные визуальные компоненты, однако, их придется интегрировать в платформу поддержки расширений, на что будет потрачено дополнительное время.

\subsubsection{Выводы}

Исходя из проведенного выше анализа следует, что разработанная платформа имеет ряд преимуществ над большинством существующих решений:

\begin{itemize}
   \item наличие полноценной среды разработки расширений;
   \item более простая интерация в существующие приложения;
   \item возможность отладки расширений.
\end{itemize}

В работе представлена таблица \ref{tabular:res_compare_tab} сравнения реализованной платформы с {\it VSTA} как c продуктом, наиболее подходящим для решения поставленой задачи, и с {\it VBA} как c <<эталонным>> решением. Сравнение проводилось по критериям, выдвинутым и описаным в разделе \ref{sec:comp_criteria}. Условные обозначения можно найти в том же разделе.

\input{analogues_comparsion_tab.tex}

Из сравнительной таблицы видно, что разработанная платформа удовлетворяет большему числу критериев, чем существующие продукты, а по простоте интеграции, исходя из опыта применения существующих решений, превосходит их.

\pagebreak
