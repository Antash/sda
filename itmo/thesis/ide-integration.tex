\subsection{Интеграция со средой разработки}

Один из важнейших сценариев использования расширяемых и автоматизируемых программных продуктов --- возможность разработки новых скриптов и редактирование кода старых в интегрированной среде разработки.

Встроенная среда разработки как правило поставляется вместе с продуктами для автоматизации приложений, например VBA или VSTA. В платформах, основная цель которых --- поддержка плагинов, напротив, встроенных средств для редактирования кода не предоставляется. Это понятно, так как считается, что конечный пользователь не будет заниматься такой сложной задачей, как написание расширения к своему приложению. Для разработчиков же существуют отдельные пакеты (SDK) для разработки расширений в различных средах разработки.

При реализации платформы для автоматизации и расширения необходимо было предоставить удобные средства редактирования кода конечному пользователю. Эта задача может быть решена несколькими способами:

Реализация собственного редактора исходного кода расширений.

Это решение имеет как и преимущества, так и целый ряд существенных недостатков. Положительным моментом этого подхода является простота интеграции в разрабатываемую платфому. Однако, реализация действительно удобного набора инструментов, таких как подсветка синтаксиса, автодополнение, автогенерация кода по шаблонам, управления файлами с исходным кодом, будет очень сложной задачей. Кроме того, результат в любом случае наврядли сравниться с современными IDE.

Использование одной из существующих IDE.

Это решение хорошо тем, что мы получаем готовую среду разработки с множеством встроенных инструментов. Одноко, встает ряд вопросов, которые необходимо решить для успешного применения сторонней IDE в разрабатываемой платформе.

Интеграция в платформу. Под интеграцией необходимо понимать возможность программного управления сторонней IDE на уровне, достаточном для того, чтобы у пользователя складывалось ощущение, что он работает с единой системой, а не несколькими разными программами.

Большинство IDE обладают куда более широким, чем нужно для разработки расширений, функционалом. Поэтому важным критерием выбора сторонней IDE является ее настраиваемость и конфигурируемость. Это касается как доступных пользователю функций, так и внешного вида самой среды.

Несмотря на предыдущий пункт, в котором сказано, что функционал современных сред разработки излишен для использования их в качастве редактора расширений, может случиться так, что некоторых специфичных функций будет нехватать. Поэтому искомая среда должна также обладать возможностью расширения функционала. Отдельным плюсом будет поддержка плагинов. Тогда можно будет отключать ненужные плагины и разработать плагины, добавляющие новый функционал.

\TODO{обзор средств}

\subsubsection{Вывод}

В качестве внешней IDE для разработки расширений была выбрана IDE с открытым исходным кодом SharpDevelop. Этот выбор был сделан по нескольким причинам:

Во-первых, эта IDE может управляться программно извне при помощи встроенной технологии SDA. Программное управление позволяет выполнять различные действия в IDE без участия пользователя. Например, показывать или скрывать само приложение, запускать сборку проекта, управлять сохранением и загрузкой проектов, и многие другие. 

Во-вторых, эта IDE поддерживает плагины. Это свойство позволит добавить какую-либо отсутствующую в базовой поставке функциональность не меняя исходного кода самого SharpDevelop. Это важно, так как изменение исходного кода сделает неудобным распространение готовой платформы, так как она будет совместима только с конкретной сборкой SharpDevelop. Использование плагинов позволит добавить нужную функцинальность в уже установленный экземпляр этой IDE.

В-третьих, SharpDevelop поддерживает кастомизацию, то есть изменение своего внешного вида и поведения при момощи конфигурационных файлов. Под изменением внешнего вида нужно понимать удаление <<лишних>> в контексте данного сценария использования (как внешней IDE для разработки расширений) элементов управления, добавление новых элементов управления, управление доступностью этих элементов, и прочее. Изменение поведения состоит в подмене штатных обработчиков событий элементов управления (например, кнопок), на свои собственные обработчики с измененной логикой. Например, запуск отладчика не должен пытаться стартовать сборку самого расширения (это попросту невозможно, так как расширения представляет из себя библиотеку классов), а присоединить отладчик к процессу хост-приложения.

В-четвертых, открытый исходных код поможет быстрее решить проблемы, связанные с интеграцией SharpDevelop в разрабатываемую платформу. Код IDE может быть отредактирован благодаря открытой лиценции GNU GPL v2. IDE может быть запущена под отладчиком для выявления и локализации проблем вызванных внешними факторами и нетипичным использованием самой IDE.

\pagebreak
