\section{Требования к платформе}
\label{sec:pl_requirements}

Платформа должна решать две основные задачи:
\begin{itemize}
 \item автоматизация ПО;
 \item расширение ПО.
\end{itemize}

В приложении, которое было разработано с использованием {\it VBA}, обе задачи решались за счёт возможности написания макросов на {\it Visual Basic}. Одни и те же макросы, в зависимости от контекста и конкретной задачи, могли как автоматизировать некоторые действия, так и расширять возможности приложения за счёт добавления нового функционала. Не было какого-то конкретного деления на <<автоматизацию>> и <<расширение>>. Поддержка макросов была реализована как некий отдельный модуль, тесно взаимодействующий с основным приложеним, что было достаточно удобно и прозрачно для пользователя. Это и навело впервые на мысль рассматривать понятия автоматизации и расширения как одно целое (далее об этом речь пойдёт в разделе~\ref{sec:autom-and-ext-as-one-thing}).

\subsubsection{Сценарии использования}
Ниже будут описаны некоторые наиболее востребованные сценарии использования в соответствии с реальным проектом, о котором говорилось в разделе~\ref{sec:problem_statement}:
\begin{enumerate}
 \item реализация дополнительного формата испорта или экспорта данных. Ядро приложения предоставляет доступ к хранилищу данных а также результатов вычислений. Помимо этого в приложении релизованы возможности экспорта и импорта в некоторых форматах. Однако иногда есть необходимость расширить набор форматов. Это можно сделать, реализовав соответствующий плагин с помощью разрабатываемой платформы;
 \item автоматизировать некоторую последовательность действий или вычислений, используя ядро приложения;
 \item добавить дополнительные диалоговые окна или элементы управления в существующий графический интерфейс пользователя, настроив таким образом приложение для конкретного пользователя;
 \item реализовать новый формат отчётов по инвестиционным портфелям в соответствии с требованиями конкретного пользователя.
\end{enumerate}

Приведённые формулировки сценариев использования довольно расплывчаты, более подробные формулировки потребовали бы углубления в детали проекта, что не имеет смысла в рамках данной главы. Однако из данных сценариев вытекают некоторые характеристики, которыми должна обладать платформа для автоматизации и расширения:
\begin{itemize}
 \item возможность контролируемого и безопасного доступа к данным приложения;
 \item возможность использования {\it API} основного приложения;
 \item возможность гибкой работы с кодом расширений --- для некоторых действий достаточно некоторого <<временного>> проекта-скрипта, который должен один раз выполниться и дальше будет невостребован, в то время как некоторые должны интегрироваться в приложение и использоваться при каждом его запуске, сохраняя возможность внесения изменений в код;
 \item возможность создания расширения сторонними разработчиками и распространения среди множества клиентов.
\end{itemize}

\subsubsection{Дополнительные возможности}
Рассмотрим некоторые дополнительные возможности, которыми могла бы обладать платформа для интеграции возсожностей автоматизации и расширения в приложения. Такие возможности не являются первостепенными, но упрощают и ускоряют процесс интеграции в ПО, а также предоставляют дополнительный функционал конечным пользователям:

\begin{itemize}
\item автоматизированные инструменты для интеграции платформы в приложения. Могут включать в себя утилиты, которые анализируют код основного приложения, предоставляя пользователю информацию об общей структуре проекта и предлагая в полуавтоматическом режиме добавлять поддержку автоматизации и расширения (к примеру, за счёт генерации прокси-объектов);
\item предоставление инструментов, упрощающих написание кода скрипта в соответствии со специфичными особенностями конкретного приложения. Это может быть реализовано, к примеру, в виде усовершенствованного IntelliSense;
\item релизация контроля зависимостей расширений. В простейшем случае предполагается, что расширение зависит только от основного приложения. Однако в более сложном случае расширение может зависеть от других установленных в приложение расширений. Такие зависимости должны отслеживаться и удовлетворяться автоматически;
\item реализация централизованного хранилища ресширений (репозитория). Сценарий использования такого репозитория следующий: разработчик крупного расширяемого программного комплекса размещает на своих серверах централизованный репозиторий поддерживаемых расширений. Расширения могут автоматически загружаться из приложения. Новые расширения могут добавляться в репозиторий как основным разработчиком приложения, так и сторонними разработчиками;
\item запись макроса (то есть последовательности пользовательских действий, выполненных с помощью графического интерфейса) и преобразование его в код.
\end{itemize}

\pagebreak
