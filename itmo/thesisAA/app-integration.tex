\subsection{Интеграция в расширяемое приложение}
\label{sec:app-integration}

Задачу интеграции разрабатываемой платформы можно разделить на два случая:

\begin{itemize}
  \item интеграция в готовое приложение;
  \item интеграция в приложение на этапе разработки.
\end{itemize}

Задача интеграции платформы в разрабатывоемое приложение не вызывает затруднений как для платформы, описываемой в работе, так и для большинства рассмотреных аналогов, так как на этом этапе программист имеет возможность продумать архитектуру приложения с учетом использования того или иного решения для интеграции возможностей автоматизации и/или расширения. Сложность интеграции в этом случае в большей степени зависит от решений, принятых разработчиком, чем от принципов, заложенных в интегрируемом продукте. Безусловно, лубой продукт требует наличия опыта работы с ним для получения лучших результатов.

Куда более интересна задача интеграции платформы в приложение, код которого уже написан, и архитектура не потерпит изменений. В этом случае большинство из существующих решений оказывабтся настолько сложны в интеграции из-за особенностей своего внутреннего устройства, что можно заявлять, что для этих продуктов такая задача будет практически неразрешимой. Все дело в сложности принципов построения взаимодействия между расширением и приложением, заложенных в большинстве существующих решений. Эти принципы сложны, потому что преследуют цели полной изоляции приложения от расширения, создания универсальных механизмов взаимодействия, а также из-за использования тех или иных шаблонов проектирования. Этот факт не делает существующие решения плохими, наоборот, все решения, используемые в этих продуктах имеют серьёзное теоретическое обоснование, диктуемое принципапи проектирования программного обеспечения, но, к сожалению, из-за этого применение существующих решений в рамках интеграции возможностей расширения в существующее приложение становиться очень трудоёмкой задачей.

В работе стояла именно задача интеграции разрабатываемой платформы в уже существующее приложение. Опираясь на результаты, полученные в предыдущих разделах, решение этой задаци состоит из нескольких этапов:

\begin{itemize}
  \item выделение в коде приложения типов, объекты которых должны быть доступны со стороны расширения;
  \item реализация этими классами интерфейса, предаставляемого модулем платформы, отвечающим за взаимодействие с расширениями;
  \item создание классов-наблюдателей, храшящих список объектов одного типа, и реагирующих на все изменения количества и состояния этих объектов;
  \item регистрация этих классов-наблюдателей в модуле поддержки взаимодействия с расширениями;
  \item внедрение пользовательских элементов управления расширениями, предоставляемых платформой.
\end{itemize}

\pagebreak
